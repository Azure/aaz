{"plane": "mgmt-plane", "resources": [{"id": "/{resourceid}/providers/microsoft.security/defenderforstoragesettings/{}", "version": "2022-12-01-preview", "swagger": "mgmt-plane/security/ResourceProviders/Microsoft.Security/Paths/L3tyZXNvdXJjZUlkfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L2RlZmVuZGVyRm9yU3RvcmFnZVNldHRpbmdzL3tzZXR0aW5nTmFtZX0=/V/MjAyMi0xMi0wMS1wcmV2aWV3"}], "commandGroups": [{"name": "security defender-for-storage settings", "commands": [{"name": "show", "version": "2022-12-01-preview", "resources": [{"id": "/{resourceid}/providers/microsoft.security/defenderforstoragesettings/{}", "version": "2022-12-01-preview", "swagger": "mgmt-plane/security/ResourceProviders/Microsoft.Security/Paths/L3tyZXNvdXJjZUlkfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L2RlZmVuZGVyRm9yU3RvcmFnZVNldHRpbmdzL3tzZXR0aW5nTmFtZX0=/V/MjAyMi0xMi0wMS1wcmV2aWV3"}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.resourceId", "options": ["resource-id"], "required": true, "help": {"short": "The identifier of the resource."}}, {"type": "string", "var": "$Path.settingName", "options": ["setting-name"], "required": true, "help": {"short": "Defender for Storage setting name."}, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"name": "current", "value": "current"}]}}]}], "operations": [{"operationId": "DefenderForStorage_Get", "http": {"path": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "resourceId", "arg": "$Path.resourceId", "required": true, "skipUrlEncoding": true}, {"type": "string", "name": "settingName", "arg": "$Path.settingName", "required": true, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"value": "current"}]}}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-12-01-preview"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{}"}}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"type": "boolean", "name": "isEnabled"}, {"type": "object", "name": "malwareScanning", "props": [{"type": "object", "name": "onUpload", "props": [{"type": "integer32", "name": "capGBPerMonth"}, {"type": "boolean", "name": "isEnabled"}], "clientFlatten": true}, {"type": "object", "name": "operationStatus", "props": [{"type": "string", "name": "code"}, {"type": "string", "name": "message"}], "cls": "OperationStatus_read"}, {"type": "string", "name": "scanResultsEventGridTopicResourceId"}], "clientFlatten": true}, {"type": "boolean", "name": "overrideSubscriptionLevelSettings"}, {"type": "object", "name": "sensitiveDataDiscovery", "props": [{"type": "boolean", "name": "isEnabled"}, {"readOnly": true, "type": "@OperationStatus_read", "name": "operationStatus"}], "clientFlatten": true}], "clientFlatten": true}, {"readOnly": true, "type": "string", "name": "type"}]}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@MgmtErrorFormat"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}, {"name": "create", "version": "2022-12-01-preview", "resources": [{"id": "/{resourceid}/providers/microsoft.security/defenderforstoragesettings/{}", "version": "2022-12-01-preview", "swagger": "mgmt-plane/security/ResourceProviders/Microsoft.Security/Paths/L3tyZXNvdXJjZUlkfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L2RlZmVuZGVyRm9yU3RvcmFnZVNldHRpbmdzL3tzZXR0aW5nTmFtZX0=/V/MjAyMi0xMi0wMS1wcmV2aWV3"}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.resourceId", "options": ["resource-id"], "required": true, "help": {"short": "The identifier of the resource."}}, {"type": "string", "var": "$Path.settingName", "options": ["setting-name"], "required": true, "help": {"short": "Defender for Storage setting name."}, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"name": "current", "value": "current"}]}}]}, {"name": "MalwareScanning", "args": [{"type": "string", "var": "$defenderForStorageSetting.properties.malwareScanning.scanResultsEventGridTopicResourceId", "options": ["scan-results-event-grid-topic-resource-id"], "group": "MalwareScanning", "help": {"short": "Optional. Resource id of an Event Grid Topic to send scan results to."}}]}, {"name": "OnUpload", "args": [{"type": "integer32", "var": "$defenderForStorageSetting.properties.malwareScanning.onUpload.capGBPerMonth", "options": ["cap-gb-per-month"], "group": "OnUpload", "help": {"short": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed."}},{"type": "boolean", "var": "$defenderForStorageSetting.properties.malwareScanning.onUpload.isEnabled", "options": ["is-enabled"], "group": "OnUpload", "help": {"short": "Indicates whether On Upload malware scanning should be enabled."}}]}, {"name": "Properties", "args": [{"type": "boolean", "var": "$defenderForStorageSetting.properties.overrideSubscriptionLevelSettings", "options": ["override-subscription-level-settings"], "group": "Properties", "help": {"short": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."}}]}, {"name": "SensitiveDataDiscovery", "args": [{"type": "boolean", "var": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled", "options": ["is-enabled"], "group": "SensitiveDataDiscovery", "help": {"short": "Indicates whether Sensitive Data Discovery should be enabled."}}]}], "operations": [{"operationId": "DefenderForStorage_Create", "http": {"path": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "resourceId", "arg": "$Path.resourceId", "required": true, "skipUrlEncoding": true}, {"type": "string", "name": "settingName", "arg": "$Path.settingName", "required": true, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"value": "current"}]}}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-12-01-preview"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"schema": {"type": "object", "name": "defenderForStorageSetting", "required": true, "props": [{"type": "object", "name": "properties", "props": [{"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.malwareScanning.onUpload.isEnabled"}, {"type": "object", "name": "malwareScanning", "props": [{"type": "object", "name": "onUpload", "props": [{"type": "integer32", "name": "capGBPerMonth", "arg": "$defenderForStorageSetting.properties.malwareScanning.onUpload.capGBPerMonth"}, {"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled"}], "clientFlatten": true}, {"type": "string", "name": "scanResultsEventGridTopicResourceId", "arg": "$defenderForStorageSetting.properties.malwareScanning.scanResultsEventGridTopicResourceId"}], "clientFlatten": true}, {"type": "boolean", "name": "overrideSubscriptionLevelSettings", "arg": "$defenderForStorageSetting.properties.overrideSubscriptionLevelSettings"}, {"type": "object", "name": "sensitiveDataDiscovery", "props": [{"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled"}], "clientFlatten": true}], "clientFlatten": true}], "clientFlatten": true}}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{}"}}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"type": "boolean", "name": "isEnabled"}, {"type": "object", "name": "malwareScanning", "props": [{"type": "object", "name": "onUpload", "props": [{"type": "integer32", "name": "capGBPerMonth"}, {"type": "boolean", "name": "isEnabled"}], "clientFlatten": true}, {"type": "object", "name": "operationStatus", "props": [{"type": "string", "name": "code"}, {"type": "string", "name": "message"}], "cls": "OperationStatus_read"}, {"type": "string", "name": "scanResultsEventGridTopicResourceId"}], "clientFlatten": true}, {"type": "boolean", "name": "overrideSubscriptionLevelSettings"}, {"type": "object", "name": "sensitiveDataDiscovery", "props": [{"type": "boolean", "name": "isEnabled"}, {"readOnly": true, "type": "@OperationStatus_read", "name": "operationStatus"}], "clientFlatten": true}], "clientFlatten": true}, {"readOnly": true, "type": "string", "name": "type"}]}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@MgmtErrorFormat"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}, {"name": "update", "version": "2022-12-01-preview", "resources": [{"id": "/{resourceid}/providers/microsoft.security/defenderforstoragesettings/{}", "version": "2022-12-01-preview", "swagger": "mgmt-plane/security/ResourceProviders/Microsoft.Security/Paths/L3tyZXNvdXJjZUlkfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5L2RlZmVuZGVyRm9yU3RvcmFnZVNldHRpbmdzL3tzZXR0aW5nTmFtZX0=/V/MjAyMi0xMi0wMS1wcmV2aWV3"}], "argGroups": [{"name": "", "args": [{"type": "string", "var": "$Path.resourceId", "options": ["resource-id"], "required": true, "help": {"short": "The identifier of the resource."}}, {"type": "string", "var": "$Path.settingName", "options": ["setting-name"], "required": true, "help": {"short": "Defender for Storage setting name."}, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"name": "current", "value": "current"}]}}]}, {"name": "MalwareScanning", "args": [{"nullable": true, "type": "string", "var": "$defenderForStorageSetting.properties.malwareScanning.scanResultsEventGridTopicResourceId", "options": ["scan-results-event-grid-topic-resource-id"], "group": "MalwareScanning", "help": {"short": "Optional. Resource id of an Event Grid Topic to send scan results to."}}]}, {"name": "OnUpload", "args": [{"nullable": true, "type": "integer32", "var": "$defenderForStorageSetting.properties.malwareScanning.onUpload.capGBPerMonth", "options": ["cap-gb-per-month"], "group": "OnUpload", "help": {"short": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed."}},{"nullable": true, "type": "boolean", "var": "$defenderForStorageSetting.properties.malwareScanning.onUpload.isEnabled", "options": ["is-enabled"], "group": "OnUpload", "help": {"short": "Indicates whether On Upload malware scanning should be enabled."}}]}, {"name": "Properties", "args": [{"nullable": true, "type": "boolean", "var": "$defenderForStorageSetting.properties.overrideSubscriptionLevelSettings", "options": ["override-subscription-level-settings"], "group": "Properties", "help": {"short": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."}}]}, {"name": "SensitiveDataDiscovery", "args": [{"nullable": true, "type": "boolean", "var": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled", "options": ["is-enabled"], "group": "SensitiveDataDiscovery", "help": {"short": "Indicates whether Sensitive Data Discovery should be enabled."}}]}], "operations": [{"operationId": "DefenderForStorage_Get", "http": {"path": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}", "request": {"method": "get", "path": {"params": [{"type": "string", "name": "resourceId", "arg": "$Path.resourceId", "required": true, "skipUrlEncoding": true}, {"type": "string", "name": "settingName", "arg": "$Path.settingName", "required": true, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"value": "current"}]}}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-12-01-preview"}, "type": "string", "name": "api-version", "required": true}]}}, "responses": [{"statusCode": [200], "body": {"json": {"var": "$Instance", "schema": {"type": "object", "props": [{"readOnly": true, "type": "ResourceId", "name": "id", "format": {"template": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{}"}}, {"readOnly": true, "type": "string", "name": "name"}, {"type": "object", "name": "properties", "props": [{"type": "boolean", "name": "isEnabled"}, {"type": "object", "name": "malwareScanning", "props": [{"type": "object", "name": "onUpload", "props": [{"type": "integer32", "name": "capGBPerMonth"}, {"type": "boolean", "name": "isEnabled"}], "clientFlatten": true}, {"type": "object", "name": "operationStatus", "props": [{"type": "string", "name": "code"}, {"type": "string", "name": "message"}], "cls": "OperationStatus_read"}, {"type": "string", "name": "scanResultsEventGridTopicResourceId"}], "clientFlatten": true}, {"type": "boolean", "name": "overrideSubscriptionLevelSettings"}, {"type": "object", "name": "sensitiveDataDiscovery", "props": [{"type": "boolean", "name": "isEnabled"}, {"readOnly": true, "type": "@OperationStatus_read", "name": "operationStatus"}], "clientFlatten": true}], "clientFlatten": true}, {"readOnly": true, "type": "string", "name": "type"}], "cls": "DefenderForStorageSetting_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@MgmtErrorFormat"}}}}]}}, {"instanceUpdate": {"ref": "$Instance", "json": {"schema": {"type": "object", "name": "defenderForStorageSetting", "required": true, "props": [{"type": "object", "name": "properties", "props": [{"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.malwareScanning.onUpload.isEnabled"}, {"type": "object", "name": "malwareScanning", "props": [{"type": "object", "name": "onUpload", "props": [{"type": "integer32", "name": "capGBPerMonth", "arg": "$defenderForStorageSetting.properties.malwareScanning.onUpload.capGBPerMonth"}, {"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled"}], "clientFlatten": true}, {"type": "string", "name": "scanResultsEventGridTopicResourceId", "arg": "$defenderForStorageSetting.properties.malwareScanning.scanResultsEventGridTopicResourceId"}], "clientFlatten": true}, {"type": "boolean", "name": "overrideSubscriptionLevelSettings", "arg": "$defenderForStorageSetting.properties.overrideSubscriptionLevelSettings"}, {"type": "object", "name": "sensitiveDataDiscovery", "props": [{"type": "boolean", "name": "isEnabled", "arg": "$defenderForStorageSetting.properties.sensitiveDataDiscovery.isEnabled"}], "clientFlatten": true}], "clientFlatten": true}], "clientFlatten": true}}}}, {"operationId": "DefenderForStorage_Create", "http": {"path": "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}", "request": {"method": "put", "path": {"params": [{"type": "string", "name": "resourceId", "arg": "$Path.resourceId", "required": true, "skipUrlEncoding": true}, {"type": "string", "name": "settingName", "arg": "$Path.settingName", "required": true, "format": {"pattern": "^[a-z][a-z0-9]*$"}, "enum": {"items": [{"value": "current"}]}}]}, "query": {"consts": [{"readOnly": true, "const": true, "default": {"value": "2022-12-01-preview"}, "type": "string", "name": "api-version", "required": true}]}, "body": {"json": {"ref": "$Instance"}}}, "responses": [{"statusCode": [200, 201], "body": {"json": {"var": "$Instance", "schema": {"type": "@DefenderForStorageSetting_read"}}}}, {"isError": true, "body": {"json": {"schema": {"type": "@MgmtErrorFormat"}}}}]}}], "outputs": [{"type": "object", "ref": "$Instance", "clientFlatten": true}]}]}]}